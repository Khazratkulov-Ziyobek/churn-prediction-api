# üè¶ Bank Churn Prediction

–°–µ—Ä–≤–∏—Å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –æ—Ç—Ç–æ–∫–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤ –±–∞–Ω–∫–∞.

---

## –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —ç—Ç–∞–ø—ã

### 1. –ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö –∏ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞
- –ó–∞–≥—Ä—É–∂–µ–Ω –¥–∞—Ç–∞—Å–µ—Ç (15 000 –∫–ª–∏–µ–Ω—Ç–æ–≤, 14 –ø—Ä–∏–∑–Ω–∞–∫–æ–≤)
- –ü—Ä–æ–≤–µ–¥—ë–Ω EDA: —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è, –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏, –∞–Ω–∞–ª–∏–∑ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
- –û–±—Ä–∞–±–æ—Ç–∞–Ω—ã –ø—Ä–æ–ø—É—Å–∫–∏ (–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –º–µ–¥–∏–∞–Ω–æ–π/–º–æ–¥–æ–π)
- –ö–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏: LabelEncoding (–ø–æ–ª), OneHotEncoding (–≥–æ—Ä–æ–¥)
- –†–∞–∑–±–∏–µ–Ω–∏–µ: 80% train / 20% test (stratified)
- –î–∏—Å–±–∞–ª–∞–Ω—Å –∫–ª–∞—Å—Å–æ–≤ –æ–±—Ä–∞–±–æ—Ç–∞–Ω —Å –ø–æ–º–æ—â—å—é SMOTE

### 2. –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ **16 –º–æ–¥–µ–ª–µ–π**, –≤–∫–ª—é—á–∞—è –∞–Ω—Å–∞–º–±–ª–∏ –∏ —Ç—é–Ω–∏–Ω–≥ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —á–µ—Ä–µ–∑ Optuna:

| –ú–æ–¥–µ–ª—å | ROC-AUC | F1-score |
|--------|---------|----------|
| **CatBoost (Optuna)** | **0.9337** | **0.7396** |
| XGBoost (Optuna) | 0.9326 | 0.7361 |
| Gradient Boosting | 0.9323 | 0.7354 |
| Voting Ensemble | 0.9322 | 0.7301 |
| Random Forest | 0.9258 | 0.7257 |
| Logistic Regression | 0.8778 | 0.6430 |

**–õ—É—á—à–∞—è –º–æ–¥–µ–ª—å:** CatBoost —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π Optuna

### 3. –í–∞–ª–∏–¥–∞—Ü–∏—è
- 5-fold –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è
- Confusion Matrix, ROC-–∫—Ä–∏–≤–∞—è
- SHAP-–∞–Ω–∞–ª–∏–∑ –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (–∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –≤ Streamlit)

### 4. API-—Å–µ—Ä–≤–∏—Å (FastAPI)
- REST API –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –æ—Ç—Ç–æ–∫–∞
- JSON –≤—Ö–æ–¥/–≤—ã—Ö–æ–¥
- Swagger-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: `/docs`

### 5. –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è
- Dockerfile –¥–ª—è —Å–±–æ—Ä–∫–∏ –æ–±—Ä–∞–∑–∞
- docker-compose.yml –¥–ª—è –∑–∞–ø—É—Å–∫–∞ API –∏ Streamlit

### 6. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ
- **Streamlit-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ** —Å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º
- SHAP-–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- –¢–∞–±–ª–∏—Ü–∞ –±–µ–Ω—á–º–∞—Ä–∫–∞ –≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π

---

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```bash
pip install -r requirements.txt
```

### –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ (Jupyter Notebook)
```bash
jupyter notebook churn_analysis.ipynb
```
–í—ã–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ —è—á–µ–π–∫–∏ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –º–æ–¥–µ–ª–∏.

---

## –ó–∞–ø—É—Å–∫ FastAPI

```bash
uvicorn api.main:app --reload --port 8000
```

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** http://localhost:8000/docs

### –ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞ (curl)
```bash
curl -X POST "http://localhost:8000/predict" \
  -H "Content-Type: application/json" \
  -d '{
    "–∫—Ä–µ–¥–∏—Ç–Ω—ã–π_—Ä–µ–π—Ç–∏–Ω–≥": 650,
    "–≥–æ—Ä–æ–¥": "–ê–ª–º–∞—Ç—ã",
    "–ø–æ–ª": "Male",
    "–≤–æ–∑—Ä–∞—Å—Ç": 35,
    "—Å—Ç–∞–∂_–≤_–±–∞–Ω–∫–µ": 5,
    "–±–∞–ª–∞–Ω—Å_–¥–µ–ø–æ–∑–∏—Ç–∞": 100000,
    "—á–∏—Å–ª–æ_–ø—Ä–æ–¥—É–∫—Ç–æ–≤": 2,
    "–µ—Å—Ç—å_–∫—Ä–µ–¥–∏—Ç–∫–∞": 1,
    "–∞–∫—Ç–∏–≤–Ω—ã–π_–∫–ª–∏–µ–Ω—Ç": 1,
    "–æ—Ü–µ–Ω–æ—á–Ω–∞—è_–∑–∞—Ä–ø–ª–∞—Ç–∞": 120000
  }'
```

### –ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞
```json
{
  "probability": 0.23,
  "prediction": 0,
  "risk_level": "–ù–∏–∑–∫–∏–π"
}
```

### –ü—Ä–∏–º–µ—Ä —Å Python (requests)
```python
import requests

data = {
    "–∫—Ä–µ–¥–∏—Ç–Ω—ã–π_—Ä–µ–π—Ç–∏–Ω–≥": 650,
    "–≥–æ—Ä–æ–¥": "–ê–ª–º–∞—Ç—ã", 
    "–ø–æ–ª": "Male",
    "–≤–æ–∑—Ä–∞—Å—Ç": 35,
    "—Å—Ç–∞–∂_–≤_–±–∞–Ω–∫–µ": 5,
    "–±–∞–ª–∞–Ω—Å_–¥–µ–ø–æ–∑–∏—Ç–∞": 100000,
    "—á–∏—Å–ª–æ_–ø—Ä–æ–¥—É–∫—Ç–æ–≤": 2,
    "–µ—Å—Ç—å_–∫—Ä–µ–¥–∏—Ç–∫–∞": 1,
    "–∞–∫—Ç–∏–≤–Ω—ã–π_–∫–ª–∏–µ–Ω—Ç": 1,
    "–æ—Ü–µ–Ω–æ—á–Ω–∞—è_–∑–∞—Ä–ø–ª–∞—Ç–∞": 120000
}

response = requests.post("http://localhost:8000/predict", json=data)
print(response.json())
```

---

## –ó–∞–ø—É—Å–∫ Streamlit (–ª–æ–∫–∞–ª—å–Ω–æ)

```bash
streamlit run streamlit_app.py
```

–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ: http://localhost:8501

---

## Docker

### –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫ (API + Streamlit)
```bash
docker-compose up --build
```

- **API:** http://localhost:8000
- **Streamlit:** http://localhost:8501

### –¢–æ–ª—å–∫–æ API
```bash
docker build -t churn-api .
docker run -p 8000:8000 churn-api
```

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
‚îú‚îÄ‚îÄ churn_analysis.ipynb   # –ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö –∏ –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îî‚îÄ‚îÄ main.py            # FastAPI —Å–µ—Ä–≤–∏—Å
‚îú‚îÄ‚îÄ streamlit_app.py       # Streamlit –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îú‚îÄ‚îÄ models/                # –°–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ –∏ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã
‚îú‚îÄ‚îÄ TZ.csv                 # –ò—Å—Ö–æ–¥–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç
‚îú‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ docker-compose.yaml
‚îú‚îÄ‚îÄ requirements.txt
‚îî‚îÄ‚îÄ README.md
```

---

## Demo

**Streamlit –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:** [—Å—Å—ã–ª–∫–∞ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è]

---

## –ú–µ—Ç—Ä–∏–∫–∏ –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ (CatBoost)

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|---------|----------|
| ROC-AUC | 0.9337 |
| Accuracy | 0.8977 |
| Precision | 0.769 |
| Recall | 0.712 |
| F1-score | 0.740 |
